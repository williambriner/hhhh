!function(e){var n={};function t(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,t),i.l=!0,i.exports}t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:o})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var i in e)t.d(o,i,function(n){return e[n]}.bind(null,i));return o},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=53)}([function(e,n){var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)},function(e,n,t){var o=t(12)("wks"),i=t(13),r=t(0).Symbol,a="function"==typeof r;(e.exports=function(e){return o[e]||(o[e]=a&&r[e]||(a?r:i)("Symbol."+e))}).store=o},function(e,n){var t=e.exports={version:"2.6.5"};"number"==typeof __e&&(__e=t)},function(e,n,t){var o=t(4);e.exports=function(e){if(!o(e))throw TypeError(e+" is not an object!");return e}},function(e,n){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,n,t){var o=t(6);e.exports=function(e,n,t){if(o(e),void 0===n)return e;switch(t){case 1:return function(t){return e.call(n,t)};case 2:return function(t,o){return e.call(n,t,o)};case 3:return function(t,o,i){return e.call(n,t,o,i)}}return function(){return e.apply(n,arguments)}}},function(e,n){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,n,t){e.exports=!t(16)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,n){var t={}.toString;e.exports=function(e){return t.call(e).slice(8,-1)}},function(e,n,t){var o=t(3),i=t(27),r=t(28),a=Object.defineProperty;n.f=t(7)?Object.defineProperty:function(e,n,t){if(o(e),n=r(n,!0),o(t),i)try{return a(e,n,t)}catch(e){}if("get"in t||"set"in t)throw TypeError("Accessors not supported!");return"value"in t&&(e[n]=t.value),e}},function(e,n){e.exports=!1},function(e,n,t){var o=t(8),i=t(1)("toStringTag"),r="Arguments"==o(function(){return arguments}());e.exports=function(e){var n,t,a;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(t=function(e,n){try{return e[n]}catch(e){}}(n=Object(e),i))?t:r?o(n):"Object"==(a=o(n))&&"function"==typeof n.callee?"Arguments":a}},function(e,n,t){var o=t(2),i=t(0),r=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(e.exports=function(e,n){return r[e]||(r[e]=void 0!==n?n:{})})("versions",[]).push({version:o.version,mode:t(10)?"pure":"global",copyright:"Â© 2019 Denis Pushkarev (zloirock.ru)"})},function(e,n){var t=0,o=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++t+o).toString(36))}},function(e,n,t){var o=t(0),i=t(2),r=t(15),a=t(18),s=t(5),c=function(e,n,t){var u,l,d,f,p=e&c.F,m=e&c.G,h=e&c.S,g=e&c.P,v=e&c.B,w=m?o:h?o[n]||(o[n]={}):(o[n]||{}).prototype,y=m?i:i[n]||(i[n]={}),C=y.prototype||(y.prototype={});for(u in m&&(t=n),t)d=((l=!p&&w&&void 0!==w[u])?w:t)[u],f=v&&l?s(d,o):g&&"function"==typeof d?s(Function.call,d):d,w&&a(w,u,d,e&c.U),y[u]!=d&&r(y,u,f),g&&C[u]!=d&&(C[u]=d)};o.core=i,c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,e.exports=c},function(e,n,t){var o=t(9),i=t(29);e.exports=t(7)?function(e,n,t){return o.f(e,n,i(1,t))}:function(e,n,t){return e[n]=t,e}},function(e,n){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,n,t){var o=t(4),i=t(0).document,r=o(i)&&o(i.createElement);e.exports=function(e){return r?i.createElement(e):{}}},function(e,n,t){var o=t(0),i=t(15),r=t(19),a=t(13)("src"),s=t(30),c=(""+s).split("toString");t(2).inspectSource=function(e){return s.call(e)},(e.exports=function(e,n,t,s){var u="function"==typeof t;u&&(r(t,"name")||i(t,"name",n)),e[n]!==t&&(u&&(r(t,a)||i(t,a,e[n]?""+e[n]:c.join(String(n)))),e===o?e[n]=t:s?e[n]?e[n]=t:i(e,n,t):(delete e[n],i(e,n,t)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[a]||s.call(this)}))},function(e,n){var t={}.hasOwnProperty;e.exports=function(e,n){return t.call(e,n)}},function(e,n){e.exports={}},function(e,n,t){var o=t(3),i=t(6),r=t(1)("species");e.exports=function(e,n){var t,a=o(e).constructor;return void 0===a||null==(t=o(a)[r])?n:i(t)}},function(e,n,t){var o,i,r,a=t(5),s=t(38),c=t(39),u=t(17),l=t(0),d=l.process,f=l.setImmediate,p=l.clearImmediate,m=l.MessageChannel,h=l.Dispatch,g=0,v={},w=function(){var e=+this;if(v.hasOwnProperty(e)){var n=v[e];delete v[e],n()}},y=function(e){w.call(e.data)};f&&p||(f=function(e){for(var n=[],t=1;arguments.length>t;)n.push(arguments[t++]);return v[++g]=function(){s("function"==typeof e?e:Function(e),n)},o(g),g},p=function(e){delete v[e]},"process"==t(8)(d)?o=function(e){d.nextTick(a(w,e,1))}:h&&h.now?o=function(e){h.now(a(w,e,1))}:m?(r=(i=new m).port2,i.port1.onmessage=y,o=a(r.postMessage,r,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(o=function(e){l.postMessage(e+"","*")},l.addEventListener("message",y,!1)):o="onreadystatechange"in u("script")?function(e){c.appendChild(u("script")).onreadystatechange=function(){c.removeChild(this),w.call(e)}}:function(e){setTimeout(a(w,e,1),0)}),e.exports={set:f,clear:p}},function(e,n,t){"use strict";var o=t(6);function i(e){var n,t;this.promise=new e((function(e,o){if(void 0!==n||void 0!==t)throw TypeError("Bad Promise constructor");n=e,t=o})),this.resolve=o(n),this.reject=o(t)}e.exports.f=function(e){return new i(e)}},function(e,n,t){var o=t(3),i=t(4),r=t(23);e.exports=function(e,n){if(o(e),i(n)&&n.constructor===e)return n;var t=r.f(e);return(0,t.resolve)(n),t.promise}},function(e,n,t){"use strict";t(26),t(47),e.exports=t(2).Promise.finally},function(e,n,t){"use strict";var o,i,r,a,s=t(10),c=t(0),u=t(5),l=t(11),d=t(14),f=t(4),p=t(6),m=t(31),h=t(32),g=t(21),v=t(22).set,w=t(40)(),y=t(23),C=t(41),S=t(42),T=t(24),b=c.TypeError,P=c.process,I=P&&P.versions,E=I&&I.v8||"",O=c.Promise,R="process"==l(P),x=function(){},M=i=y.f,A=!!function(){try{var e=O.resolve(1),n=(e.constructor={})[t(1)("species")]=function(e){e(x,x)};return(R||"function"==typeof PromiseRejectionEvent)&&e.then(x)instanceof n&&0!==E.indexOf("6.6")&&-1===S.indexOf("Chrome/66")}catch(e){}}(),_=function(e){var n;return!(!f(e)||"function"!=typeof(n=e.then))&&n},k=function(e,n){if(!e._n){e._n=!0;var t=e._c;w((function(){for(var o=e._v,i=1==e._s,r=0,a=function(n){var t,r,a,s=i?n.ok:n.fail,c=n.resolve,u=n.reject,l=n.domain;try{s?(i||(2==e._h&&D(e),e._h=1),!0===s?t=o:(l&&l.enter(),t=s(o),l&&(l.exit(),a=!0)),t===n.promise?u(b("Promise-chain cycle")):(r=_(t))?r.call(t,c,u):c(t)):u(o)}catch(e){l&&!a&&l.exit(),u(e)}};t.length>r;)a(t[r++]);e._c=[],e._n=!1,n&&!e._h&&N(e)}))}},N=function(e){v.call(c,(function(){var n,t,o,i=e._v,r=F(e);if(r&&(n=C((function(){R?P.emit("unhandledRejection",i,e):(t=c.onunhandledrejection)?t({promise:e,reason:i}):(o=c.console)&&o.error&&o.error("Unhandled promise rejection",i)})),e._h=R||F(e)?2:1),e._a=void 0,r&&n.e)throw n.v}))},F=function(e){return 1!==e._h&&0===(e._a||e._c).length},D=function(e){v.call(c,(function(){var n;R?P.emit("rejectionHandled",e):(n=c.onrejectionhandled)&&n({promise:e,reason:e._v})}))},L=function(e){var n=this;n._d||(n._d=!0,(n=n._w||n)._v=e,n._s=2,n._a||(n._a=n._c.slice()),k(n,!0))},W=function(e){var n,t=this;if(!t._d){t._d=!0,t=t._w||t;try{if(t===e)throw b("Promise can't be resolved itself");(n=_(e))?w((function(){var o={_w:t,_d:!1};try{n.call(e,u(W,o,1),u(L,o,1))}catch(e){L.call(o,e)}})):(t._v=e,t._s=1,k(t,!1))}catch(e){L.call({_w:t,_d:!1},e)}}};A||(O=function(e){m(this,O,"Promise","_h"),p(e),o.call(this);try{e(u(W,this,1),u(L,this,1))}catch(e){L.call(this,e)}},(o=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=t(43)(O.prototype,{then:function(e,n){var t=M(g(this,O));return t.ok="function"!=typeof e||e,t.fail="function"==typeof n&&n,t.domain=R?P.domain:void 0,this._c.push(t),this._a&&this._a.push(t),this._s&&k(this,!1),t.promise},catch:function(e){return this.then(void 0,e)}}),r=function(){var e=new o;this.promise=e,this.resolve=u(W,e,1),this.reject=u(L,e,1)},y.f=M=function(e){return e===O||e===a?new r(e):i(e)}),d(d.G+d.W+d.F*!A,{Promise:O}),t(44)(O,"Promise"),t(45)("Promise"),a=t(2).Promise,d(d.S+d.F*!A,"Promise",{reject:function(e){var n=M(this);return(0,n.reject)(e),n.promise}}),d(d.S+d.F*(s||!A),"Promise",{resolve:function(e){return T(s&&this===a?O:this,e)}}),d(d.S+d.F*!(A&&t(46)((function(e){O.all(e).catch(x)}))),"Promise",{all:function(e){var n=this,t=M(n),o=t.resolve,i=t.reject,r=C((function(){var t=[],r=0,a=1;h(e,!1,(function(e){var s=r++,c=!1;t.push(void 0),a++,n.resolve(e).then((function(e){c||(c=!0,t[s]=e,--a||o(t))}),i)})),--a||o(t)}));return r.e&&i(r.v),t.promise},race:function(e){var n=this,t=M(n),o=t.reject,i=C((function(){h(e,!1,(function(e){n.resolve(e).then(t.resolve,o)}))}));return i.e&&o(i.v),t.promise}})},function(e,n,t){e.exports=!t(7)&&!t(16)((function(){return 7!=Object.defineProperty(t(17)("div"),"a",{get:function(){return 7}}).a}))},function(e,n,t){var o=t(4);e.exports=function(e,n){if(!o(e))return e;var t,i;if(n&&"function"==typeof(t=e.toString)&&!o(i=t.call(e)))return i;if("function"==typeof(t=e.valueOf)&&!o(i=t.call(e)))return i;if(!n&&"function"==typeof(t=e.toString)&&!o(i=t.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,n){e.exports=function(e,n){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:n}}},function(e,n,t){e.exports=t(12)("native-function-to-string",Function.toString)},function(e,n){e.exports=function(e,n,t,o){if(!(e instanceof n)||void 0!==o&&o in e)throw TypeError(t+": incorrect invocation!");return e}},function(e,n,t){var o=t(5),i=t(33),r=t(34),a=t(3),s=t(35),c=t(37),u={},l={};(n=e.exports=function(e,n,t,d,f){var p,m,h,g,v=f?function(){return e}:c(e),w=o(t,d,n?2:1),y=0;if("function"!=typeof v)throw TypeError(e+" is not iterable!");if(r(v)){for(p=s(e.length);p>y;y++)if((g=n?w(a(m=e[y])[0],m[1]):w(e[y]))===u||g===l)return g}else for(h=v.call(e);!(m=h.next()).done;)if((g=i(h,w,m.value,n))===u||g===l)return g}).BREAK=u,n.RETURN=l},function(e,n,t){var o=t(3);e.exports=function(e,n,t,i){try{return i?n(o(t)[0],t[1]):n(t)}catch(n){var r=e.return;throw void 0!==r&&o(r.call(e)),n}}},function(e,n,t){var o=t(20),i=t(1)("iterator"),r=Array.prototype;e.exports=function(e){return void 0!==e&&(o.Array===e||r[i]===e)}},function(e,n,t){var o=t(36),i=Math.min;e.exports=function(e){return e>0?i(o(e),9007199254740991):0}},function(e,n){var t=Math.ceil,o=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?o:t)(e)}},function(e,n,t){var o=t(11),i=t(1)("iterator"),r=t(20);e.exports=t(2).getIteratorMethod=function(e){if(null!=e)return e[i]||e["@@iterator"]||r[o(e)]}},function(e,n){e.exports=function(e,n,t){var o=void 0===t;switch(n.length){case 0:return o?e():e.call(t);case 1:return o?e(n[0]):e.call(t,n[0]);case 2:return o?e(n[0],n[1]):e.call(t,n[0],n[1]);case 3:return o?e(n[0],n[1],n[2]):e.call(t,n[0],n[1],n[2]);case 4:return o?e(n[0],n[1],n[2],n[3]):e.call(t,n[0],n[1],n[2],n[3])}return e.apply(t,n)}},function(e,n,t){var o=t(0).document;e.exports=o&&o.documentElement},function(e,n,t){var o=t(0),i=t(22).set,r=o.MutationObserver||o.WebKitMutationObserver,a=o.process,s=o.Promise,c="process"==t(8)(a);e.exports=function(){var e,n,t,u=function(){var o,i;for(c&&(o=a.domain)&&o.exit();e;){i=e.fn,e=e.next;try{i()}catch(o){throw e?t():n=void 0,o}}n=void 0,o&&o.enter()};if(c)t=function(){a.nextTick(u)};else if(!r||o.navigator&&o.navigator.standalone)if(s&&s.resolve){var l=s.resolve(void 0);t=function(){l.then(u)}}else t=function(){i.call(o,u)};else{var d=!0,f=document.createTextNode("");new r(u).observe(f,{characterData:!0}),t=function(){f.data=d=!d}}return function(o){var i={fn:o,next:void 0};n&&(n.next=i),e||(e=i,t()),n=i}}},function(e,n){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,n,t){var o=t(0).navigator;e.exports=o&&o.userAgent||""},function(e,n,t){var o=t(18);e.exports=function(e,n,t){for(var i in n)o(e,i,n[i],t);return e}},function(e,n,t){var o=t(9).f,i=t(19),r=t(1)("toStringTag");e.exports=function(e,n,t){e&&!i(e=t?e:e.prototype,r)&&o(e,r,{configurable:!0,value:n})}},function(e,n,t){"use strict";var o=t(0),i=t(9),r=t(7),a=t(1)("species");e.exports=function(e){var n=o[e];r&&n&&!n[a]&&i.f(n,a,{configurable:!0,get:function(){return this}})}},function(e,n,t){var o=t(1)("iterator"),i=!1;try{var r=[7][o]();r.return=function(){i=!0},Array.from(r,(function(){throw 2}))}catch(e){}e.exports=function(e,n){if(!n&&!i)return!1;var t=!1;try{var r=[7],a=r[o]();a.next=function(){return{done:t=!0}},r[o]=function(){return a},e(r)}catch(e){}return t}},function(e,n,t){"use strict";var o=t(14),i=t(2),r=t(0),a=t(21),s=t(24);o(o.P+o.R,"Promise",{finally:function(e){var n=a(this,i.Promise||r.Promise),t="function"==typeof e;return this.then(t?function(t){return s(n,e()).then((function(){return t}))}:e,t?function(t){return s(n,e()).then((function(){throw t}))}:e)}})},function(e,n,t){self,e.exports=(()=>{var e={22:(e,n,t)=>{var o=t(481),i=t(426),r=i;r.v1=o,r.v4=i,e.exports=r},725:e=>{for(var n=[],t=0;t<256;++t)n[t]=(t+256).toString(16).substr(1);e.exports=function(e,t){var o=t||0,i=n;return[i[e[o++]],i[e[o++]],i[e[o++]],i[e[o++]],"-",i[e[o++]],i[e[o++]],"-",i[e[o++]],i[e[o++]],"-",i[e[o++]],i[e[o++]],"-",i[e[o++]],i[e[o++]],i[e[o++]],i[e[o++]],i[e[o++]],i[e[o++]]].join("")}},157:e=>{var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var t=new Uint8Array(16);e.exports=function(){return n(t),t}}else{var o=new Array(16);e.exports=function(){for(var e,n=0;n<16;n++)0==(3&n)&&(e=4294967296*Math.random()),o[n]=e>>>((3&n)<<3)&255;return o}}},481:(e,n,t)=>{var o,i,r=t(157),a=t(725),s=0,c=0;e.exports=function(e,n,t){var u=n&&t||0,l=n||[],d=(e=e||{}).node||o,f=void 0!==e.clockseq?e.clockseq:i;if(null==d||null==f){var p=r();null==d&&(d=o=[1|p[0],p[1],p[2],p[3],p[4],p[5]]),null==f&&(f=i=16383&(p[6]<<8|p[7]))}var m=void 0!==e.msecs?e.msecs:(new Date).getTime(),h=void 0!==e.nsecs?e.nsecs:c+1,g=m-s+(h-c)/1e4;if(g<0&&void 0===e.clockseq&&(f=f+1&16383),(g<0||m>s)&&void 0===e.nsecs&&(h=0),h>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=m,c=h,i=f;var v=(1e4*(268435455&(m+=122192928e5))+h)%4294967296;l[u++]=v>>>24&255,l[u++]=v>>>16&255,l[u++]=v>>>8&255,l[u++]=255&v;var w=m/4294967296*1e4&268435455;l[u++]=w>>>8&255,l[u++]=255&w,l[u++]=w>>>24&15|16,l[u++]=w>>>16&255,l[u++]=f>>>8|128,l[u++]=255&f;for(var y=0;y<6;++y)l[u+y]=d[y];return n||a(l)}},426:(e,n,t)=>{var o=t(157),i=t(725);e.exports=function(e,n,t){var r=n&&t||0;"string"==typeof e&&(n="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||o)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,n)for(var s=0;s<16;++s)n[r+s]=a[s];return n||i(a)}}},n={};function t(o){var i=n[o];if(void 0!==i)return i.exports;var r=n[o]={exports:{}};return e[o](r,r.exports,t),r.exports}t.d=(e,n)=>{for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})},t.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),t.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};return(()=>{"use strict";t.r(o),t.d(o,{ChannelType:()=>k,ChildAppWindow:()=>Ce,DialogDimension:()=>P,ErrorCode:()=>$,FileOpenPreference:()=>Y,FrameContexts:()=>S,HostClientType:()=>y,HostName:()=>C,NotificationTypes:()=>K,ParentAppWindow:()=>Se,TaskModuleDimension:()=>U,TeamType:()=>T,UserSettingTypes:()=>J,UserTeamRole:()=>b,ViewerActionTypes:()=>Q,app:()=>D,appEntity:()=>je,appInitialization:()=>Ne,appInstallDialog:()=>ee,authentication:()=>N,bot:()=>q,calendar:()=>Re,call:()=>ke,chat:()=>X,core:()=>L,dialog:()=>ye,enablePrintCapability:()=>Ze,executeDeepLink:()=>un,files:()=>Le,getContext:()=>Ke,getMruTabInstances:()=>sn,getTabInstances:()=>an,initialize:()=>Ge,initializeWithFrameContext:()=>dn,legacy:()=>We,location:()=>Ie,logs:()=>v,mail:()=>xe,media:()=>Pe,meeting:()=>Ee,meetingRoom:()=>Ue,menus:()=>w,monetization:()=>Oe,navigateBack:()=>hn,navigateCrossDomain:()=>mn,navigateToTab:()=>pn,notifications:()=>He,pages:()=>W,people:()=>Me,print:()=>qe,registerAppButtonClickHandler:()=>Xe,registerAppButtonHoverEnterHandler:()=>Ye,registerAppButtonHoverLeaveHandler:()=>$e,registerBackButtonHandler:()=>en,registerBeforeUnloadHandler:()=>tn,registerCustomHandler:()=>A,registerEnterSettingsHandler:()=>rn,registerFocusEnterHandler:()=>on,registerFullScreenHandler:()=>Je,registerOnLoadHandler:()=>nn,registerOnThemeChangeHandler:()=>Qe,registerUserSettingsChangeHandler:()=>_,remoteCamera:()=>Be,returnFocus:()=>fn,sendCustomEvent:()=>M,sendCustomMessage:()=>x,setFrameContext:()=>ln,settings:()=>Fe,shareDeepLink:()=>cn,sharing:()=>_e,tasks:()=>De,teams:()=>ze,teamsCore:()=>F,uploadCustomApp:()=>R,video:()=>Ae});var e="2.0.0-beta.2",n="2.0.1",i="1.9.0",r="1.8.0",a=["teams.microsoft.com","teams.microsoft.us","gov.teams.microsoft.us","dod.teams.microsoft.us","int.teams.microsoft.com","teams.live.com","devspaces.skype.com","ssauth.skype.com","local.teams.live.com","local.teams.live.com:8080","local.teams.office.com","local.teams.office.com:8080","msft.spoppe.com","*.sharepoint.com","*.sharepoint-df.com","*.sharepointonline.com","outlook.office.com","outlook-sdf.office.com","*.teams.microsoft.com","www.office.com","word.office.com","excel.office.com","powerpoint.office.com","www.officeppe.com","*.www.office.com"],s=/^https:\/\//,c=function(){function e(){}return e.initializeCalled=!1,e.initializeCompleted=!1,e.additionalValidOrigins=[],e.isFramelessWindow=!1,e.printCapabilityEnabled=!1,e}(),u=t(22);function l(e,n){if("*."===e.substring(0,2)){var t=e.substring(1);if(n.length>t.length&&n.split(".").length===t.split(".").length&&n.substring(n.length-t.length)===t)return!0}else if(e===n)return!0;return!1}function d(e,n){if("string"!=typeof e||"string"!=typeof n)return NaN;var t=e.split("."),o=n.split(".");function i(e){return/^\d+$/.test(e)}if(!t.every(i)||!o.every(i))return NaN;for(;t.length<o.length;)t.push("0");for(;o.length<t.length;)o.push("0");for(var r=0;r<t.length;++r)if(Number(t[r])!=Number(o[r]))return Number(t[r])>Number(o[r])?1:-1;return 0}function f(e,n){for(var t=[],o=2;o<arguments.length;o++)t[o-2]=arguments[o];var i=e.apply(void 0,t);return i.then((function(e){n&&n(void 0,e)})).catch((function(e){n&&n(e)})),i}function p(e,n){for(var t=[],o=2;o<arguments.length;o++)t[o-2]=arguments[o];var i=e.apply(void 0,t);return i.then((function(){n&&n(null)})).catch((function(e){n&&n(e)})),i}function m(e,n){for(var t=[],o=2;o<arguments.length;o++)t[o-2]=arguments[o];var i=e.apply(void 0,t);return i.then((function(e){n&&n(null,e)})).catch((function(e){n&&n(e,null)})),i}function h(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(!c.initializeCalled)throw new Error("The library has not yet been initialized");if(c.frameContext&&e&&e.length>0){for(var t=!1,o=0;o<e.length;o++)if(e[o]===c.frameContext){t=!0;break}if(!t)throw new Error("This call is not allowed in the '"+c.frameContext+"' context")}}function g(e){void 0===e&&(e=n);var t=d(c.clientSupportedSDKVersion,e);return!isNaN(t)&&t>=0}var v,w,y,C,S,T,b,P,I={apiVersion:1,supports:{appInstallDialog:void 0,bot:void 0,calendar:void 0,call:void 0,chat:void 0,dialog:void 0,location:void 0,logs:void 0,mail:void 0,media:void 0,meeting:void 0,meetingRoom:void 0,menus:void 0,monetization:void 0,notifications:void 0,pages:{appButton:void 0,tabs:void 0,config:void 0,backStack:void 0,fullTrust:void 0},people:void 0,remoteCamera:void 0,sharing:void 0,teams:{fullTrust:void 0},teamsCore:void 0,video:void 0}},E={apiVersion:1,supports:{appInstallDialog:{},appEntity:{},bot:{},calendar:{},call:{},chat:{},dialog:{},files:{},location:{},logs:{},mail:{},media:{},meeting:{},meetingRoom:{},menus:{},monetization:{},notifications:{},pages:{appButton:{},tabs:{},config:{},backStack:{},fullTrust:{}},people:{},remoteCamera:{},sharing:{},teams:{fullTrust:{}},teamsCore:{},video:{}}};function O(e){I=function e(n){return Object.keys(n).forEach((function(t){"object"==typeof n[t]&&e(n[t])})),Object.freeze(n)}(e)}function R(e,n){h(),le("uploadCustomApp",[e],n||function(e){return function(n,t){if(!n)throw new Error(e||t)}}())}function x(e,n,t){h(),le(e,n,t)}function M(e,n){if(h(),!te.childWindow)throw new Error("The child window has not yet been initialized or is not present");we(e,n)}function A(e,n){var t=this;h(),j(e,(function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return n.apply(t,e)}))}function _(e,n){h(),j("userSettingsChange",n,!0,[e])}!function(e){e.registerGetLogHandler=function(e){h(),e?j("log.request",(function(){le("log.receive",[e()])})):z("log.request")},e.isSupported=function(){return!!I.supports.logs}}(v||(v={})),function(e){var n,t,o,i=function(){this.enabled=!0,this.selected=!1};function r(e){o&&o(e)||(h(),le("viewConfigItemPress",[e]))}function a(e){n&&n(e)||(h(),le("handleNavBarMenuItemPress",[e]))}function s(e){t&&t(e)||(h(),le("handleActionMenuItemPress",[e]))}e.MenuItem=i,function(e){e.dropDown="dropDown",e.popOver="popOver"}(e.MenuListType||(e.MenuListType={})),e.initialize=function(){j("navBarMenuItemPress",a,!1),j("actionMenuItemPress",s,!1),j("setModuleView",r,!1)},e.setUpViews=function(e,n){h(),o=n,le("setUpViews",[e])},e.setNavBarMenu=function(e,t){h(),n=t,le("setNavBarMenu",[e])},e.showActionMenu=function(e,n){h(),t=n,le("showActionMenu",[e])},e.isSupported=function(){return!!I.supports.menus}}(w||(w={})),function(e){e.desktop="desktop",e.web="web",e.android="android",e.ios="ios",e.rigel="rigel",e.surfaceHub="surfaceHub",e.teamsRoomsWindows="teamsRoomsWindows",e.teamsRoomsAndroid="teamsRoomsAndroid",e.teamsPhones="teamsPhones",e.teamsDisplays="teamsDisplays"}(y||(y={})),function(e){e.office="Office",e.outlook="Outlook",e.orange="Orange",e.teams="Teams"}(C||(C={})),function(e){e.settings="settings",e.content="content",e.authentication="authentication",e.remove="remove",e.task="task",e.sidePanel="sidePanel",e.stage="stage",e.meetingStage="meetingStage"}(S||(S={})),function(e){e[e.Standard=0]="Standard",e[e.Edu=1]="Edu",e[e.Class=2]="Class",e[e.Plc=3]="Plc",e[e.Staff=4]="Staff"}(T||(T={})),function(e){e[e.Admin=0]="Admin",e[e.User=1]="User",e[e.Guest=2]="Guest"}(b||(b={})),function(e){e.Large="large",e.Medium="medium",e.Small="small"}(P||(P={}));var k,N,F,D,L,W,U=P;!function(e){e.Regular="Regular",e.Private="Private",e.Shared="Shared"}(k||(k={})),function(e){var n,t,o;function i(e){return new Promise((function(t,o){if(c.hostClientType===y.desktop||c.hostClientType===y.android||c.hostClientType===y.ios||c.hostClientType===y.rigel||c.hostClientType===y.teamsRoomsWindows||c.hostClientType===y.teamsRoomsAndroid||c.hostClientType===y.teamsPhones||c.hostClientType===y.teamsDisplays){var i=document.createElement("a");i.href=e.url,t(ue("authentication.authenticate",[i.href,e.width,e.height]).then((function(e){var n=e[0],t=e[1];if(n)return t;throw new Error(t)})))}else n={success:t,fail:o},function(e){r();var n=e.width||600,t=e.height||400;n=Math.min(n,te.currentWindow.outerWidth-400),t=Math.min(t,te.currentWindow.outerHeight-200);var o=document.createElement("a");o.href=e.url;var i=void 0!==te.currentWindow.screenLeft?te.currentWindow.screenLeft:te.currentWindow.screenX,a=void 0!==te.currentWindow.screenTop?te.currentWindow.screenTop:te.currentWindow.screenY;i+=te.currentWindow.outerWidth/2-n/2,a+=te.currentWindow.outerHeight/2-t/2,te.childWindow=te.currentWindow.open(o.href,"_blank","toolbar=no, location=yes, status=no, menubar=no, scrollbars=yes, top="+a+", left="+i+", width="+n+", height="+t),te.childWindow?s():l("FailedToOpenWindow")}(e)}))}function r(){a();try{te.childWindow&&te.childWindow.close()}finally{te.childWindow=null,te.childOrigin=null}}function a(){t&&(clearInterval(t),t=0),z("initialize"),z("navigateCrossDomain")}function s(){a(),t=te.currentWindow.setInterval((function(){if(!te.childWindow||te.childWindow.closed)l("CancelledByUser");else{var e=te.childOrigin;try{te.childOrigin="*",we("ping")}finally{te.childOrigin=e}}}),100),j("initialize",(function(){return[S.authentication,c.hostClientType]})),j("navigateCrossDomain",(function(){return!1}))}function u(e){try{n&&n.success(e)}finally{n=null,r()}}function l(e){try{n&&n.fail(new Error(e))}finally{n=null,r()}}function d(e,n,t){if(e){var o=document.createElement("a");o.href=decodeURIComponent(e),o.host&&o.host!==window.location.host&&"outlook.office.com"===o.host&&o.search.indexOf("client_type=Win32_Outlook")>-1&&(n&&"result"===n&&(t&&(o.href=f(o.href,"result",t)),te.currentWindow.location.assign(f(o.href,"authSuccess",""))),n&&"reason"===n&&(t&&(o.href=f(o.href,"reason",t)),te.currentWindow.location.assign(f(o.href,"authFailure",""))))}}function f(e,n,t){var o=e.indexOf("#"),i=-1===o?"#":e.substr(o);return i=i+"&"+n+(""!==t?"="+t:""),(e=-1===o?e:e.substr(0,o))+i}e.initialize=function(){j("authentication.authenticate.success",u,!1),j("authentication.authenticate.failure",l,!1)},e.registerAuthenticationHandlers=function(e){o=e},e.authenticate=function(e){var n=void 0!==e,t=n?e:o;if(!t)throw new Error("No parameters are provided for authentication");return h(S.content,S.sidePanel,S.settings,S.remove,S.task,S.stage,S.meetingStage),i(t).then((function(e){try{return t&&t.successCallback?(t.successCallback(e),""):e}finally{n||(o=null)}})).catch((function(e){try{if(t&&t.failureCallback)return t.failureCallback(e.message),"";throw e}finally{n||(o=null)}}))},e.getAuthToken=function(e){return h(),function(e){return new Promise((function(n){n(ue("authentication.getAuthToken",[e.resources,e.claims,e.silent]))})).then((function(e){var n=e[0],t=e[1];if(n)return t;throw new Error(t)}))}(e).then((function(n){return e&&e.successCallback?(e.successCallback(n),""):n})).catch((function(n){if(e&&e.failureCallback)return e.failureCallback(n.message),"";throw n}))},e.getUser=function(e){return h(),new Promise((function(e){e(ue("authentication.getUser"))})).then((function(e){var n=e[0],t=e[1];if(n)return t;throw new Error(t)})).then((function(n){return e&&e.successCallback?(e.successCallback(n),null):n})).catch((function(n){if(e&&e.failureCallback)return e.failureCallback(n.message),null;throw n}))},e.notifySuccess=function(e,n){d(n,"result",e),h(S.authentication),le("authentication.authenticate.success",[e]),ge(te.parentWindow,(function(){return setTimeout((function(){return te.currentWindow.close()}),200)}))},e.notifyFailure=function(e,n){d(n,"reason",e),h(S.authentication),le("authentication.authenticate.failure",[e]),ge(te.parentWindow,(function(){return setTimeout((function(){return te.currentWindow.close()}),200)}))}}(N||(N={})),function(e){function n(){window.print()}e.enablePrintCapability=function(){c.printCapabilityEnabled||(c.printCapabilityEnabled=!0,h(),document.addEventListener("keydown",(function(e){(e.ctrlKey||e.metaKey)&&80===e.keyCode&&(n(),e.cancelBubble=!0,e.preventDefault(),e.stopImmediatePropagation())})))},e.print=n,e.registerOnLoadHandler=function(e){h(),function(e){H.loadHandler=e,e&&le("registerHandler",["load"])}(e)},e.registerBeforeUnloadHandler=function(e){h(),function(e){H.beforeUnloadHandler=e,e&&le("registerHandler",["beforeUnload"])}(e)},e.registerFocusEnterHandler=function(e){h(),j("focusEnter",e)},e.isSupported=function(){return!!I.supports.teamsCore}}(F||(F={})),function(t){function o(e){h(),function(e){H.themeChangeHandler=e,e&&le("registerHandler",["themeChange"])}(e)}t.Messages={AppLoaded:"appInitialization.appLoaded",Success:"appInitialization.success",Failure:"appInitialization.failure",ExpectedFailure:"appInitialization.expectedFailure"},function(e){e.AuthFailed="AuthFailed",e.Timeout="Timeout",e.Other="Other"}(t.FailedReason||(t.FailedReason={})),function(e){e.PermissionError="PermissionError",e.NotFound="NotFound",e.Throttling="Throttling",e.Offline="Offline",e.Other="Other"}(t.ExpectedFailureReason||(t.ExpectedFailureReason={})),t.isInitialized=function(){return c.initializeCalled},t.getFrameContext=function(){return c.frameContext},t.initialize=function(e){return new Promise((function(t){c.initializeCalled||(c.initializeCalled=!0,H.handlers.themeChange=V,H.handlers.load=G,H.handlers.beforeUnload=Z,W.backStack._initialize(),c.initializePromise=ie(e).then((function(e){var t=e.context,o=e.clientType,i=e.runtimeConfig,r=e.clientSupportedSDKVersion,a=void 0===r?n:r;c.frameContext=t,c.hostClientType=o,c.clientSupportedSDKVersion=a;try{var s=JSON.parse(i);i&&O(s)}catch(e){if(!(e instanceof SyntaxError))throw e;try{isNaN(d(i,n))||(c.clientSupportedSDKVersion=i),s=JSON.parse(a),a&&O(s)}catch(e){if(!(e instanceof SyntaxError))throw e;O(E)}}c.initializeCompleted=!0})),N.initialize(),W.config.initialize(),w.initialize()),Array.isArray(e)&&function(e){var n=c.additionalValidOrigins.concat(e.filter((function(e){return"string"==typeof e&&s.test(e)}))),t={};n=n.filter((function(e){return!t[e]&&(t[e]=!0,!0)})),c.additionalValidOrigins=n}(e),t(c.initializePromise)}))},t._initialize=function(e){te.currentWindow=e},t._uninitialize=function(){c.initializeCalled&&(c.frameContext&&(o(null),W.backStack.registerBackButtonHandler(null),W.registerFullScreenHandler(null),F.registerBeforeUnloadHandler(null),F.registerOnLoadHandler(null),v.registerGetLogHandler(null)),c.frameContext===S.settings&&W.config.registerOnSaveHandler(null),c.frameContext===S.remove&&W.config.registerOnRemoveHandler(null),c.initializeCalled=!1,c.initializeCompleted=!1,c.initializePromise=null,c.additionalValidOrigins=[],c.frameContext=null,c.hostClientType=null,c.isFramelessWindow=!1,te.currentWindow.removeEventListener("message",oe.messageListener,!1),te.parentWindow=null,te.parentOrigin=null,te.childWindow=null,te.childOrigin=null,oe.parentMessageQueue=[],oe.childMessageQueue=[],oe.nextMessageId=0,oe.callbacks={})},t.getContext=function(){return new Promise((function(e){h(),e(re("getContext"))})).then((function(e){return function(e){return{app:{locale:e.locale,sessionId:e.appSessionId?e.appSessionId:"",theme:e.theme?e.theme:"default",iconPositionVertical:e.appIconPosition,osLocaleInfo:e.osLocaleInfo,parentMessageId:e.parentMessageId,userClickTime:e.userClickTime,userFileOpenPreference:e.userFileOpenPreference,host:{name:e.hostName?e.hostName:C.teams,clientType:e.hostClientType?e.hostClientType:y.web,sessionId:e.sessionId?e.sessionId:"",ringId:e.ringId},appLaunchId:e.appLaunchId},page:{id:e.entityId,frameContext:e.frameContext?e.frameContext:c.frameContext,subPageId:e.subEntityId,isFullScreen:e.isFullScreen,isMultiWindow:e.isMultiWindow,sourceOrigin:e.sourceOrigin},user:{id:e.userObjectId,displayName:e.userDisplayName,isCallingAllowed:e.isCallingAllowed,isPSTNCallingAllowed:e.isPSTNCallingAllowed,licenseType:e.userLicenseType,loginHint:e.loginHint,userPrincipalName:e.userPrincipalName,tenant:e.tid?{id:e.tid,teamsSku:e.tenantSKU}:void 0},channel:e.channelId?{id:e.channelId,displayName:e.channelName,relativeUrl:e.channelRelativeUrl,membershipType:e.channelType,defaultOneNoteSectionId:e.defaultOneNoteSectionId,ownerGroupId:e.hostTeamGroupId,ownerTenantId:e.hostTeamTenantId}:void 0,chat:e.chatId?{id:e.chatId}:void 0,meeting:e.meetingId?{id:e.meetingId}:void 0,sharepoint:e.sharepoint,team:e.teamId?{internalId:e.teamId,displayName:e.teamName,type:e.teamType,groupId:e.groupId,templateId:e.teamTemplateId,isArchived:e.isTeamArchived,userRole:e.userTeamRole}:void 0,sharePointSite:e.teamSiteUrl||e.teamSiteDomain||e.teamSitePath?{url:e.teamSiteUrl,domain:e.teamSiteDomain,path:e.teamSitePath,id:e.teamSiteId}:void 0}}(e)}))},t.notifyAppLoaded=function(){h(),le(t.Messages.AppLoaded,[e])},t.notifySuccess=function(){h(),le(t.Messages.Success,[e])},t.notifyFailure=function(e){h(),le(t.Messages.Failure,[e.reason,e.message])},t.notifyExpectedFailure=function(e){h(),le(t.Messages.ExpectedFailure,[e.reason,e.message])},t.registerOnThemeChangeHandler=o}(D||(D={})),function(e){e.shareDeepLink=function(e){h(S.content,S.sidePanel,S.meetingStage),le("shareDeepLink",[e.subEntityId,e.subEntityLabel,e.subEntityWebUrl])},e.executeDeepLink=function(e){return new Promise((function(n){h(S.content,S.sidePanel,S.settings,S.task,S.stage,S.meetingStage),n(ae("executeDeepLink",e))}))}}(L||(L={})),function(e){function n(e){h(S.content),le("setFrameContext",[e])}e.returnFocus=function(e){h(S.content),le("returnFocus",[e])},e.setCurrentFrame=n,e.initializeWithFrameContext=function(e,t,o){D.initialize(o).then((function(){return t&&t()})),n(e)},e.navigateCrossDomain=function(e){return new Promise((function(n){h(S.content,S.sidePanel,S.settings,S.remove,S.task,S.stage,S.meetingStage),n(se("navigateCrossDomain","Cross-origin navigation is only supported for URLs matching the pattern registered in the manifest.",e))}))},e.registerFullScreenHandler=function(e){h(),j("fullScreenChange",e)},e.isSupported=function(){return!!I.supports.pages},function(e){e.navigateToTab=function(e){return new Promise((function(n){h(),n(se("navigateToTab","Invalid internalTabInstanceId and/or channelId were/was provided",e))}))},e.getTabInstances=function(e){return new Promise((function(n){h(),n(re("getTabInstances",e))}))},e.getMruTabInstances=function(e){return new Promise((function(n){h(),n(re("getMruTabInstances",e))}))},e.isSupported=function(){return!!I.supports.pages&&!!I.supports.pages.tabs}}(e.tabs||(e.tabs={})),function(e){var n,t;function o(e){var t=new i(e);n?n(t):t.notifySuccess()}e.initialize=function(){j("settings.save",o,!1),j("settings.remove",r,!1)},e.setValidityState=function(e){h(S.settings,S.remove),le("settings.setValidityState",[e])},e.getConfig=function(){return new Promise((function(e){h(S.content,S.settings,S.remove,S.sidePanel),e(re("settings.getSettings"))}))},e.setConfig=function(e){return new Promise((function(n){h(S.content,S.settings,S.sidePanel),n(ae("settings.setSettings",e))}))},e.registerOnSaveHandler=function(e){h(S.settings),n=e,e&&le("registerHandler",["save"])},e.registerOnRemoveHandler=function(e){h(S.remove,S.settings),t=e,e&&le("registerHandler",["remove"])},e.registerChangeConfigHandler=function(e){h(S.content),j("changeSettings",e)};var i=function(){function e(e){this.notified=!1,this.result=e||{}}return e.prototype.notifySuccess=function(){this.ensureNotNotified(),le("settings.save.success"),this.notified=!0},e.prototype.notifyFailure=function(e){this.ensureNotNotified(),le("settings.save.failure",[e]),this.notified=!0},e.prototype.ensureNotNotified=function(){if(this.notified)throw new Error("The SaveEvent may only notify success or failure once.")},e}();function r(){var e=new a;t?t(e):e.notifySuccess()}var a=function(){function e(){this.notified=!1}return e.prototype.notifySuccess=function(){this.ensureNotNotified(),le("settings.remove.success"),this.notified=!0},e.prototype.notifyFailure=function(e){this.ensureNotNotified(),le("settings.remove.failure",[e]),this.notified=!0},e.prototype.ensureNotNotified=function(){if(this.notified)throw new Error("The removeEvent may only notify success or failure once.")},e}();e.isSupported=function(){return!!I.supports.pages&&!!I.supports.pages.config}}(e.config||(e.config={})),function(e){var n;function t(){return new Promise((function(e){h(),e(se("navigateBack","Back navigation is not supported in the current client or context."))}))}function o(){n&&n()||t()}e._initialize=function(){j("backButtonPress",o,!1)},e.navigateBack=t,e.registerBackButtonHandler=function(e){n=e,e&&le("registerHandler",["backButton"])},e.isSupported=function(){return!!I.supports.pages&&!!I.supports.pages.backStack}}(e.backStack||(e.backStack={})),function(e){e.enterFullscreen=function(){h(S.content),le("enterFullscreen",[])},e.exitFullscreen=function(){h(S.content),le("exitFullscreen",[])},e.isSupported=function(){return!!I.supports.pages&&!!I.supports.pages.fullTrust}}(e.fullTrust||(e.fullTrust={})),function(e){e.onClick=function(e){h(S.content),j("appButtonClick",e)},e.onHoverEnter=function(e){h(S.content),j("appButtonHoverEnter",e)},e.onHoverLeave=function(e){h(S.content),j("appButtonHoverLeave",e)},e.isSupported=function(){return!!I.supports.pages&&!!I.supports.pages.appButton}}(e.appButton||(e.appButton={}))}(W||(W={}));var H=function(){function e(){}return e.handlers={},e}();function B(e,n){var t=H.handlers[e];return t?[!0,t.apply(this,n)]:[!1,void 0]}function j(e,n,t,o){void 0===t&&(t=!0),void 0===o&&(o=[]),n?(H.handlers[e]=n,t&&le("registerHandler",function(e,n,t){if(t||2===arguments.length)for(var o,i=0,r=n.length;i<r;i++)!o&&i in n||(o||(o=Array.prototype.slice.call(n,0,i)),o[i]=n[i]);return e.concat(o||Array.prototype.slice.call(n))}([e],o,!0))):delete H.handlers[e]}function z(e){delete H.handlers[e]}function V(e){H.themeChangeHandler&&H.themeChangeHandler(e),te.childWindow&&we("themeChange",[e])}function G(e){H.loadHandler&&H.loadHandler(e),te.childWindow&&we("load",[e])}function Z(){var e=function(){le("readyToUnload",[])};H.beforeUnloadHandler&&H.beforeUnloadHandler(e)||e()}var q,K,Q,J,X,Y,$,ee,ne=function(e,n,t){if(t||2===arguments.length)for(var o,i=0,r=n.length;i<r;i++)!o&&i in n||(o||(o=Array.prototype.slice.call(n,0,i)),o[i]=n[i]);return e.concat(o||Array.prototype.slice.call(n))},te=function(){},oe=function(){function e(){}return e.parentMessageQueue=[],e.childMessageQueue=[],e.nextMessageId=0,e.callbacks={},e.promiseCallbacks={},e}();function ie(n){oe.messageListener=function(e){return function(e){if(e&&e.data&&"object"==typeof e.data){var n=e.source||e.originalEvent&&e.originalEvent.source,t=e.origin||e.originalEvent&&e.originalEvent.origin;(function(e,n){return(!te.currentWindow||e!==te.currentWindow)&&(!!(te.currentWindow&&te.currentWindow.location&&n&&n===te.currentWindow.location.origin)||function(e){if("https:"!==e.protocol)return!1;var n=e.host;if(a.some((function(e){return l(e,n)})))return!0;for(var t=0,o=c.additionalValidOrigins;t<o.length;t++){var i=o[t];if(l("https://"===i.substring(0,8)?i.substring(8):i,n))return!0}return!1}(new URL(n)))})(n,t)&&(function(e,n){c.isFramelessWindow||te.parentWindow&&!te.parentWindow.closed&&e!==te.parentWindow?te.childWindow&&!te.childWindow.closed&&e!==te.childWindow||(te.childWindow=e,te.childOrigin=n):(te.parentWindow=e,te.parentOrigin=n),te.parentWindow&&te.parentWindow.closed&&(te.parentWindow=null,te.parentOrigin=null),te.childWindow&&te.childWindow.closed&&(te.childWindow=null,te.childOrigin=null),he(te.parentWindow),he(te.childWindow)}(n,t),n===te.parentWindow?fe(e):n===te.childWindow&&function(e){if("id"in e.data&&"func"in e.data){var n=e.data,t=B(n.func,n.args),o=t[0],i=t[1];o&&void 0!==i?ve(n.id,Array.isArray(i)?i:[i]):le(n.func,n.args,(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(te.childWindow){var o=e.pop();ve(n.id,e,o)}}))}}(e))}}(e)},te.currentWindow=te.currentWindow||window,te.parentWindow=te.currentWindow.parent!==te.currentWindow.self?te.currentWindow.parent:te.currentWindow.opener,(te.parentWindow||n)&&te.currentWindow.addEventListener("message",oe.messageListener,!1),te.parentWindow||(c.isFramelessWindow=!0,window.onNativeMessage=fe);try{return te.parentOrigin="*",ue("initialize",[e]).then((function(e){return{context:e[0],clientType:e[1],runtimeConfig:e[2],clientSupportedSDKVersion:e[3]}}))}finally{te.parentOrigin=null}}function re(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];return ue(e,n).then((function(e){return e[0]}))}function ae(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];return ue(e,n).then((function(e){var n=e[0],t=e[1];if(!n)throw new Error(t)}))}function se(e,n){for(var t=[],o=2;o<arguments.length;o++)t[o-2]=arguments[o];return ue(e,t).then((function(e){var t=e[0],o=e[1];if(!t)throw new Error(o||n)}))}function ce(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];return ue(e,n).then((function(e){var n=e[0],t=e[1];if(n)throw n;return t}))}function ue(e,n){return void 0===n&&(n=void 0),new Promise((function(t){t(function(e){return new Promise((function(n){oe.promiseCallbacks[e]=n}))}(de(e,n).id))}))}function le(e,n,t){var o;n instanceof Function?t=n:n instanceof Array&&(o=n);var i=de(e,o);t&&(oe.callbacks[i.id]=t)}function de(e,n){var t=te.parentWindow,o=function(e,n){return{id:oe.nextMessageId++,func:e,timestamp:Date.now(),args:n||[]}}(e,n);if(c.isFramelessWindow)te.currentWindow&&te.currentWindow.nativeInterface&&te.currentWindow.nativeInterface.framelessPostMessage(JSON.stringify(o));else{var i=me(t);t&&i?t.postMessage(o,i):pe(t).push(o)}return o}function fe(e){if("id"in e.data&&"number"==typeof e.data.id){var n=e.data,t=oe.callbacks[n.id];t&&(t.apply(null,ne(ne([],n.args,!0),[n.isPartialResponse],!1)),function(e){return!0===e.data.isPartialResponse}(e)||delete oe.callbacks[n.id]);var o=oe.promiseCallbacks[n.id];o&&(o(n.args),delete oe.promiseCallbacks[n.id])}else"func"in e.data&&"string"==typeof e.data.func&&B((n=e.data).func,n.args)}function pe(e){return e===te.parentWindow?oe.parentMessageQueue:e===te.childWindow?oe.childMessageQueue:[]}function me(e){return e===te.parentWindow?te.parentOrigin:e===te.childWindow?te.childOrigin:null}function he(e){for(var n=me(e),t=pe(e);e&&n&&t.length>0;)e.postMessage(t.shift(),n)}function ge(e,n){var t=te.currentWindow.setInterval((function(){0===pe(e).length&&(clearInterval(t),n())}),100)}function ve(e,n,t){var o=te.childWindow,i=function(e,n,t){return{id:e,args:n||[],isPartialResponse:t}}(e,n,t),r=me(o);o&&r&&o.postMessage(i,r)}function we(e,n){var t=te.childWindow,o=function(e,n){return{func:e,args:n||[]}}(e,n),i=me(t);t&&i?t.postMessage(o,i):pe(t).push(o)}!function(e){e.sendQuery=function(e,n,t){h(),le("bot.executeQuery",[e],(function(e,o){e?n(o):t(o)}))},e.getSupportedCommands=function(e,n){h(),le("bot.getSupportedCommands",(function(t,o){t?e(o):n(o)}))},e.authenticate=function(e,n,t){h(),le("bot.authenticate",[e],(function(e,o){e?n(o):t(o)}))},function(e){e.Results="Results",e.Auth="Auth"}(e.ResponseType||(e.ResponseType={})),e.isSupported=function(){return!!I.supports.bot}}(q||(q={})),function(e){e.fileDownloadStart="fileDownloadStart",e.fileDownloadComplete="fileDownloadComplete"}(K||(K={})),function(e){e.view="view",e.edit="edit",e.editNew="editNew"}(Q||(Q={})),function(e){e.fileOpenPreference="fileOpenPreference",e.theme="theme"}(J||(J={})),function(e){e.openConversation=function(e){return new Promise((function(n){h(S.content);var t=ae("conversations.openConversation",{title:e.title,subEntityId:e.subEntityId,conversationId:e.conversationId,channelId:e.channelId,entityId:e.entityId});e.onStartConversation&&j("startConversation",(function(n,t,o,i){return e.onStartConversation({subEntityId:n,conversationId:t,channelId:o,entityId:i})})),e.onCloseConversation&&j("closeConversation",(function(n,t,o,i){return e.onCloseConversation({subEntityId:n,conversationId:t,channelId:o,entityId:i})})),n(t)}))},e.closeConversation=function(){h(S.content),le("conversations.closeConversation"),z("startConversation"),z("closeConversation")},e.getChatMembers=function(){return new Promise((function(e){h(),e(re("getChatMembers"))}))},e.isSupported=function(){return!!I.supports.chat}}(X||(X={})),function(e){e.Inline="inline",e.Desktop="desktop",e.Web="web"}(Y||(Y={})),function(e){e[e.NOT_SUPPORTED_ON_PLATFORM=100]="NOT_SUPPORTED_ON_PLATFORM",e[e.INTERNAL_ERROR=500]="INTERNAL_ERROR",e[e.NOT_SUPPORTED_IN_CURRENT_CONTEXT=501]="NOT_SUPPORTED_IN_CURRENT_CONTEXT",e[e.PERMISSION_DENIED=1e3]="PERMISSION_DENIED",e[e.NETWORK_ERROR=2e3]="NETWORK_ERROR",e[e.NO_HW_SUPPORT=3e3]="NO_HW_SUPPORT",e[e.INVALID_ARGUMENTS=4e3]="INVALID_ARGUMENTS",e[e.UNAUTHORIZED_USER_OPERATION=5e3]="UNAUTHORIZED_USER_OPERATION",e[e.INSUFFICIENT_RESOURCES=6e3]="INSUFFICIENT_RESOURCES",e[e.THROTTLE=7e3]="THROTTLE",e[e.USER_ABORT=8e3]="USER_ABORT",e[e.OPERATION_TIMED_OUT=8001]="OPERATION_TIMED_OUT",e[e.OLD_PLATFORM=9e3]="OLD_PLATFORM",e[e.FILE_NOT_FOUND=404]="FILE_NOT_FOUND",e[e.SIZE_EXCEEDED=1e4]="SIZE_EXCEEDED"}($||($={})),function(e){function n(){return!!I.supports.appInstallDialog}e.openAppInstallDialog=function(e){return new Promise((function(t){if(h(S.content,S.sidePanel,S.settings,S.task,S.stage,S.meetingStage),!n())throw"Not supported";le("appInstallDialog.openAppInstallDialog",[e]),t()}))},e.isSupported=n}(ee||(ee={}));var ye,Ce=function(){function e(){}return e.prototype.postMessage=function(e,n){return h(),this.postMessageHelper(e).then((function(){n&&n(!0)})).catch((function(e){if(!n)throw e;n(!1,e.message)}))},e.prototype.postMessageHelper=function(e){return new Promise((function(n){n(ae("messageForChild",e))}))},e.prototype.addEventListener=function(e,n){"message"===e&&j("messageForParent",n)},e}(),Se=function(){function e(){}return Object.defineProperty(e,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!1,configurable:!0}),e.prototype.postMessage=function(e,n){return h(S.task),this.postMessageHelper(e).then((function(){n&&n(!0)})).catch((function(e){if(!n)throw e;n(!1,e.message)}))},e.prototype.postMessageHelper=function(e){return new Promise((function(n){n(ae("messageForParent",e))}))},e.prototype.addEventListener=function(e,n){"message"===e&&j("messageForChild",n)},e}();function Te(e,n){if(null==e||null==n||e.length<=0)return null;var t,o=1;return e.sort((function(e,n){return e.sequence>n.sequence?1:-1})),e.forEach((function(e){e.sequence==o&&(t=t?new Blob([t,e.file],{type:n}):new Blob([e.file],{type:n}),o++)})),t}function be(e,n){if(null==e||null==n)return null;for(var t=atob(e.chunk),o=new Array(t.length),i=0;i<t.length;i++)o[i]=t.charCodeAt(i);var r=new Uint8Array(o),a=new Blob([r],{type:n});return{sequence:e.chunkSequence,file:a}}!function(e){e.open=function(e,n){return h(S.content,S.sidePanel,S.meetingStage),le("tasks.startTask",[e],n),new Ce},e.resize=function(e){h(S.task),e.width,e.height;var n=function(e,n){var t={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&n.indexOf(o)<0&&(t[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)n.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(t[o[i]]=e[o[i]])}return t}(e,["width","height"]);if(Object.keys(n).length)throw new Error("resize requires a dialogInfo argument containing only width and height");le("tasks.updateTask",[e])},e.submit=function(e,n){h(S.task),le("tasks.completeTask",[e,Array.isArray(n)?n:[n]])},e.isSupported=function(){return!!I.supports.dialog}}(ye||(ye={}));var Pe,Ie,Ee,Oe,Re,xe,Me,Ae,_e,ke,Ne,Fe,De,Le,We,Ue,He,Be,je,ze,Ve=function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])})(n,t)};return function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();function Ge(e,n){D.initialize(n).then((function(){e&&e()}))}function Ze(){F.enablePrintCapability()}function qe(){F.print()}function Ke(e){h(),D.getContext().then((function(n){e&&e(function(e){return{locale:e.app.locale,appSessionId:e.app.sessionId,theme:e.app.theme,appIconPosition:e.app.iconPositionVertical,osLocaleInfo:e.app.osLocaleInfo,parentMessageId:e.app.parentMessageId,userClickTime:e.app.userClickTime,userFileOpenPreference:e.app.userFileOpenPreference,appLaunchId:e.app.appLaunchId,hostClientType:e.app.host.clientType,sessionId:e.app.host.sessionId,ringId:e.app.host.ringId,entityId:e.page.id,frameContext:e.page.frameContext,subEntityId:e.page.subPageId,isFullScreen:e.page.isFullScreen,isMultiWindow:e.page.isMultiWindow,sourceOrigin:e.page.sourceOrigin,userObjectId:void 0!==e.user?e.user.id:void 0,isCallingAllowed:void 0!==e.user?e.user.isCallingAllowed:void 0,isPSTNCallingAllowed:void 0!==e.user?e.user.isPSTNCallingAllowed:void 0,userLicenseType:void 0!==e.user?e.user.licenseType:void 0,loginHint:void 0!==e.user?e.user.loginHint:void 0,userPrincipalName:void 0!==e.user?e.user.userPrincipalName:void 0,tid:void 0!==e.user&&void 0!==e.user.tenant?e.user.tenant.id:void 0,tenantSKU:void 0!==e.user&&void 0!==e.user.tenant?e.user.tenant.teamsSku:void 0,channelId:void 0!==e.channel?e.channel.id:void 0,channelName:void 0!==e.channel?e.channel.displayName:void 0,channelRelativeUrl:void 0!==e.channel?e.channel.relativeUrl:void 0,channelType:void 0!==e.channel?e.channel.membershipType:void 0,defaultOneNoteSectionId:void 0!==e.channel?e.channel.defaultOneNoteSectionId:void 0,hostTeamGroupId:void 0!==e.channel?e.channel.ownerGroupId:void 0,hostTeamTenantId:void 0!==e.channel?e.channel.ownerTenantId:void 0,chatId:void 0!==e.chat?e.chat.id:void 0,meetingId:void 0!==e.meeting?e.meeting.id:void 0,sharepoint:e.sharepoint,teamId:void 0!==e.team?e.team.internalId:void 0,teamName:void 0!==e.team?e.team.displayName:void 0,teamType:void 0!==e.team?e.team.type:void 0,groupId:void 0!==e.team?e.team.groupId:void 0,teamTemplateId:void 0!==e.team?e.team.templateId:void 0,isTeamArchived:void 0!==e.team?e.team.isArchived:void 0,userTeamRole:void 0!==e.team?e.team.userRole:void 0,teamSiteUrl:void 0!==e.sharePointSite?e.sharePointSite.url:void 0,teamSiteDomain:void 0!==e.sharePointSite?e.sharePointSite.domain:void 0,teamSitePath:void 0!==e.sharePointSite?e.sharePointSite.path:void 0,teamSiteId:void 0!==e.sharePointSite?e.sharePointSite.id:void 0}}(n))}))}function Qe(e){D.registerOnThemeChangeHandler(e)}function Je(e){W.registerFullScreenHandler(e)}function Xe(e){W.appButton.onClick(e)}function Ye(e){W.appButton.onHoverEnter(e)}function $e(e){W.appButton.onHoverLeave(e)}function en(e){W.backStack.registerBackButtonHandler(e)}function nn(e){F.registerOnLoadHandler(e)}function tn(e){F.registerBeforeUnloadHandler(e)}function on(e){F.registerFocusEnterHandler(e)}function rn(e){W.config.registerChangeConfigHandler(e)}function an(e,n){h(),W.tabs.getTabInstances(n).then((function(n){e(n)}))}function sn(e,n){h(),W.tabs.getMruTabInstances(n).then((function(n){e(n)}))}function cn(e){L.shareDeepLink(e)}function un(e,n){h(S.content,S.sidePanel,S.settings,S.task,S.stage,S.meetingStage),L.executeDeepLink(e).then((function(){n&&n(!0)})).catch((function(e){n&&n(!1,e.message)}))}function ln(e){W.setCurrentFrame(e)}function dn(e,n,t){W.initializeWithFrameContext(e,n,t)}function fn(e){W.returnFocus(e)}function pn(e,n){h(),W.tabs.navigateToTab(e).then((function(){n&&n(!0)})).catch((function(e){n&&n(!1,e.message)}))}function mn(e,n){h(S.content,S.sidePanel,S.settings,S.remove,S.task,S.stage,S.meetingStage),W.navigateCrossDomain(e).then((function(){n&&n(!0)})).catch((function(e){n&&n(!1,e.message)}))}function hn(e){h(),W.backStack.navigateBack().then((function(){e&&e(!0)})).catch((function(n){e&&e(!1,n.message)}))}!function(e){!function(e){e.Base64="base64",e.ID="id"}(e.FileFormat||(e.FileFormat={}));var n=function(){};e.File=n,e.captureImage=function(e){return h(S.content,S.task),f((function(){return new Promise((function(e){if(!c.isFramelessWindow)throw{errorCode:$.NOT_SUPPORTED_ON_PLATFORM};if(!g("1.7.0"))throw{errorCode:$.OLD_PLATFORM};e(ce("captureImage"))}))}),e)};var t=function(e){function n(n){void 0===n&&(n=null);var t=e.call(this)||this;return n&&(t.content=n.content,t.format=n.format,t.mimeType=n.mimeType,t.name=n.name,t.preview=n.preview,t.size=n.size),t}return Ve(n,e),n.prototype.getMedia=function(e){var n=this;return h(S.content,S.task),f((function(){return new Promise((function(e){if(!g(r))throw{errorCode:$.OLD_PLATFORM};if(!function(e,n,t){return null!=e&&null!=n&&n==Pe.FileFormat.ID&&null!=t}(n.mimeType,n.format,n.content))throw{errorCode:$.INVALID_ARGUMENTS};g("2.0.0")?e(n.getMediaViaCallback()):e(n.getMediaViaHandler())}))}),e)},n.prototype.getMediaViaCallback=function(){var e=this;return new Promise((function(n,t){var o={mediaMimeType:e.mimeType,assembleAttachment:[]};le("getMedia",[e.content],(function(e){if(e&&e.error)t(e.error);else if(e&&e.mediaChunk)if(e.mediaChunk.chunkSequence<=0){var i=Te(o.assembleAttachment,o.mediaMimeType);n(i)}else{var r=be(e.mediaChunk,o.mediaMimeType);o.assembleAttachment.push(r)}else t({errorCode:$.INTERNAL_ERROR,message:"data received is null"})}))}))},n.prototype.getMediaViaHandler=function(){var e=this;return new Promise((function(n,t){var o=u.v4(),i={mediaMimeType:e.mimeType,assembleAttachment:[]},r=[o,e.content];e.content&&le("getMedia",r),j("getMedia"+o,(function(e){try{var r=JSON.parse(e);if(r.error)t(r.error),z("getMedia"+o);else if(r&&r.mediaChunk)if(r.mediaChunk.chunkSequence<=0){var a=Te(i.assembleAttachment,i.mediaMimeType);n(a),z("getMedia"+o)}else{var s=be(r.mediaChunk,i.mediaMimeType);i.assembleAttachment.push(s)}else t({errorCode:$.INTERNAL_ERROR,message:"data received is null"}),z("getMedia"+o)}catch(n){t({errorCode:$.INTERNAL_ERROR,message:"Error parsing the response: "+e})}}))}))},n}(n);e.Media=t,function(e){e[e.Photo=1]="Photo",e[e.Document=2]="Document",e[e.Whiteboard=3]="Whiteboard",e[e.BusinessCard=4]="BusinessCard"}(e.CameraStartMode||(e.CameraStartMode={})),function(e){e[e.Camera=1]="Camera",e[e.Gallery=2]="Gallery"}(e.Source||(e.Source={})),function(e){e[e.Image=1]="Image",e[e.VideoAndImage=3]="VideoAndImage",e[e.Audio=4]="Audio"}(e.MediaType||(e.MediaType={})),function(e){e[e.ID=1]="ID",e[e.URL=2]="URL"}(e.ImageUriType||(e.ImageUriType={})),e.selectMedia=function(e,n){return h(S.content,S.task),f((function(){return new Promise((function(n){if(!g(r))throw{errorCode:$.OLD_PLATFORM};if(function(e){return!(!e||e.mediaType!=Pe.MediaType.VideoAndImage&&!e.videoAndImageProps)}(e)){if(c.hostClientType!=y.android&&c.hostClientType!=y.ios)throw{errorCode:$.NOT_SUPPORTED_ON_PLATFORM};if(!g("2.0.2"))throw{errorCode:$.OLD_PLATFORM}}if(!function(e){return!(null==e||e.maxMediaCount>10)}(e))throw{errorCode:$.INVALID_ARGUMENTS};n(ue("selectMedia",[e]))})).then((function(e){var n=e[0],o=e[1];if(!o)throw n;for(var i=[],r=0,a=o;r<a.length;r++){var s=a[r];i.push(new t(s))}return i}))}),n)},e.viewImages=function(e,n){return h(S.content,S.task),p((function(){return new Promise((function(n){if(!g(r))throw{errorCode:$.OLD_PLATFORM};if(!function(e){return!(null==e||e.length<=0||e.length>10)}(e))throw{errorCode:$.INVALID_ARGUMENTS};n(ce("viewImages",e))}))}),n)},e.scanBarCode=function(e,n){var t,o;return void 0===e?o=n:"object"==typeof e?o=e:(t=e,o=n),h(S.content,S.task),f((function(){return new Promise((function(e){if(c.hostClientType===y.desktop||c.hostClientType===y.web||c.hostClientType===y.rigel||c.hostClientType===y.teamsRoomsWindows||c.hostClientType===y.teamsRoomsAndroid||c.hostClientType===y.teamsPhones||c.hostClientType===y.teamsDisplays)throw{errorCode:$.NOT_SUPPORTED_ON_PLATFORM};if(!g("1.9.0"))throw{errorCode:$.OLD_PLATFORM};if(!function(e){return!e||!(null===e.timeOutIntervalInSec||e.timeOutIntervalInSec<=0||e.timeOutIntervalInSec>60)}(o))throw{errorCode:$.INVALID_ARGUMENTS};e(ce("media.scanBarCode",o))}))}),t)},e.isSupported=function(){return!!I.supports.media}}(Pe||(Pe={})),function(e){function n(e){return new Promise((function(n){if(!g(i))throw{errorCode:$.OLD_PLATFORM};if(!e)throw{errorCode:$.INVALID_ARGUMENTS};n(ce("location.getLocation",e))}))}function t(e){return new Promise((function(n){if(!g(i))throw{errorCode:$.OLD_PLATFORM};if(!e)throw{errorCode:$.INVALID_ARGUMENTS};n(ce("location.showLocation",e))}))}e.getLocation=function(e,t){return h(S.content,S.task),f(n,t,e)},e.showLocation=function(e,n){return h(S.content,S.task),function(e,n){for(var t=[],o=2;o<arguments.length;o++)t[o-2]=arguments[o];var i=e.apply(void 0,t);return i.then((function(){n&&n(void 0,!0)})).catch((function(e){n&&n(e,!1)})),i}(t,n,e)},e.showLocationHelper=t,e.isSupported=function(){return!!I.supports.location}}(Ie||(Ie={})),function(e){function n(){return new Promise((function(e){e(ce("getIncomingClientAudioState"))}))}function t(){return new Promise((function(e){e(ce("toggleIncomingClientAudio"))}))}function o(){return new Promise((function(e){e(ce("meeting.getMeetingDetails"))}))}function i(){return new Promise((function(e){e(ce("meeting.getAuthenticationTokenForAnonymousUser"))}))}function r(){return new Promise((function(e){e(ce("meeting.getLiveStreamState"))}))}function a(e,n){return new Promise((function(t){t(ce("meeting.requestStartLiveStreaming",e,n))}))}function s(){return new Promise((function(e){e(ce("meeting.requestStopLiveStreaming"))}))}function c(e){return new Promise((function(n){n(ce("meeting.shareAppContentToStage",e))}))}function u(){return new Promise((function(e){e(ce("meeting.getAppContentStageSharingCapabilities"))}))}function l(){return new Promise((function(e){e(ce("meeting.stopSharingAppContentToStage"))}))}function d(){return new Promise((function(e){e(ce("meeting.getAppContentStageSharingState"))}))}!function(e){e.Unknown="Unknown",e.Adhoc="Adhoc",e.Scheduled="Scheduled",e.Recurring="Recurring",e.Broadcast="Broadcast",e.MeetNow="MeetNow"}(e.MeetingType||(e.MeetingType={})),e.getIncomingClientAudioState=function(e){return h(S.sidePanel,S.meetingStage),m(n,e)},e.toggleIncomingClientAudio=function(e){return h(S.sidePanel,S.meetingStage),m(t,e)},e.getMeetingDetails=function(e){return h(S.sidePanel,S.meetingStage,S.settings,S.content),m(o,e)},e.getAuthenticationTokenForAnonymousUser=function(e){return h(S.sidePanel,S.meetingStage),m(i,e)},e.isSupported=function(){return!!I.supports.meeting},e.getLiveStreamState=function(e){return h(),m(r,e)},e.requestStartLiveStreaming=function(e,n,t){var o,i,r,s,c;return h(S.sidePanel),"function"==typeof e?(c=(o=[e,n,t])[0],r=o[1],s=o[2]):"string"==typeof e&&(r=(i=[e,n])[0],s=i[1]),p(a,c,r,s)},e.requestStopLiveStreaming=function(e){return h(S.sidePanel),p(s,e)},e.registerLiveStreamChangedHandler=function(e){if(!e)throw new Error("[register live stream changed handler] Handler cannot be null");h(S.sidePanel),j("meeting.liveStreamChanged",e)},e.shareAppContentToStage=function(e,n){var t,o,i;return h(S.sidePanel),"function"==typeof e?(i=(t=[e,n])[0],o=t[1]):o=e,m(c,i,o)},e.getAppContentStageSharingCapabilities=function(e){return h(S.sidePanel),m(u,e)},e.stopSharingAppContentToStage=function(e){return h(S.sidePanel),m(l,e)},e.getAppContentStageSharingState=function(e){return h(S.sidePanel),m(d,e)}}(Ee||(Ee={})),function(e){e.openPurchaseExperience=function(e,n){if(!e)throw new Error("[open purchase experience] Callback cannot be null");h(S.content),le("monetization.openPurchaseExperience",[n],e)},e.isSupported=function(){return!!I.supports.monetization}}(Oe||(Oe={})),function(e){function n(){return!!I.supports.calendar}e.openCalendarItem=function(e){return new Promise((function(t){if(h(S.content),!n())throw"Not Supported";t(ae("calendar.openCalendarItem",e))}))},e.composeMeeting=function(e){return new Promise((function(t){if(h(S.content),!n())throw"Not Supported";t(ae("calendar.composeMeeting",e))}))},e.isSupported=n}(Re||(Re={})),function(e){function n(){return!!I.supports.mail}e.openMailItem=function(e){return new Promise((function(t){if(h(S.content),!n())throw"Not Supported";t(ae("mail.openMailItem",e))}))},e.composeMail=function(e){return new Promise((function(t){if(h(S.content),!n())throw"Not Supported";t(ae("mail.composeMail",e))}))},e.isSupported=n,function(e){e.New="new",e.Reply="reply",e.ReplyAll="replyAll",e.Forward="forward"}(e.ComposeMailType||(e.ComposeMailType={}))}(xe||(xe={})),function(e){function n(e){return new Promise((function(n){if(!g("2.0.0"))throw{errorCode:$.OLD_PLATFORM};if(!function(e){if(e){if(e.title&&"string"!=typeof e.title)return!1;if(e.setSelected&&"object"!=typeof e.setSelected)return!1;if(e.openOrgWideSearchInChatOrChannel&&"boolean"!=typeof e.openOrgWideSearchInChatOrChannel)return!1;if(e.singleSelect&&"boolean"!=typeof e.singleSelect)return!1}return!0}(e))throw{errorCode:$.INVALID_ARGUMENTS};n(ce("people.selectPeople",e))}))}e.selectPeople=function(e,t){var o,i,r;return h(S.content,S.task,S.settings),"function"==typeof e?(i=(o=[e,t])[0],r=o[1]):r=e,f(n,i,r)},e.isSupported=function(){return!!I.supports.people}}(Me||(Me={})),function(e){function n(){le("video.videoFrameProcessed")}function t(e){le("video.notifyError",[e])}!function(e){e[e.NV12=0]="NV12"}(e.VideoFrameFormat||(e.VideoFrameFormat={})),function(e){e[e.EffectChanged=0]="EffectChanged",e[e.EffectDisabled=1]="EffectDisabled"}(e.EffectChangeType||(e.EffectChangeType={})),e.registerForVideoFrame=function(e,o){h(S.sidePanel),j("video.newVideoFrame",(function(o){void 0!==o&&e(o,n,t)})),le("video.registerForVideoFrame",[o])},e.notifySelectedVideoEffectChanged=function(e,n){h(S.sidePanel),le("video.videoEffectChanged",[e,n])},e.registerForVideoEffect=function(e){h(S.sidePanel),j("video.effectParameterChange",e)},e.isSupported=function(){return!!I.supports.video}}(Ae||(Ae={})),function(e){e.SharingAPIMessages={shareWebContent:"sharing.shareWebContent"},e.shareWebContent=function(n,t){(function(e,n){return!!(e&&e.content&&e.content.length)||(n&&n({errorCode:$.INVALID_ARGUMENTS,message:"Shared content is missing"}),!1)})(n,t)&&function(e,n){return e.content.some((function(e){return!e.type}))?(n&&n({errorCode:$.INVALID_ARGUMENTS,message:"Shared content type cannot be undefined"}),!1):!e.content.some((function(n){return n.type!==e.content[0].type}))||(n&&n({errorCode:$.INVALID_ARGUMENTS,message:"Shared content must be of the same type"}),!1)}(n,t)&&function(e,n){return"URL"!==e.content[0].type?(n&&n({errorCode:$.INVALID_ARGUMENTS,message:"Content type is unsupported"}),!1):!e.content.some((function(e){return!e.url}))||(n&&n({errorCode:$.INVALID_ARGUMENTS,message:"URLs are required for URL content types"}),!1)}(n,t)&&(h(S.content,S.sidePanel,S.task,S.stage,S.meetingStage),le(e.SharingAPIMessages.shareWebContent,[n],t))},e.isSupported=function(){return!!I.supports.sharing}}(_e||(_e={})),function(e){function n(){return!!I.supports.call}!function(e){e.Unknown="unknown",e.Audio="audio",e.Video="video",e.VideoBasedScreenSharing="videoBasedScreenSharing",e.Data="data"}(e.CallModalities||(e.CallModalities={})),e.startCall=function(e){return new Promise((function(t){if(h(S.content),!n())throw"Not supported";return le("call.startCall",[e],t)}))},e.isSupported=n}(ke||(ke={})),function(e){e.Messages=D.Messages,e.FailedReason=D.FailedReason,e.ExpectedFailureReason=D.ExpectedFailureReason,e.notifyAppLoaded=function(){D.notifyAppLoaded()},e.notifySuccess=function(){D.notifySuccess()},e.notifyFailure=function(e){D.notifyFailure(e)},e.notifyExpectedFailure=function(e){D.notifyExpectedFailure(e)}}(Ne||(Ne={})),function(e){e.setValidityState=function(e){W.config.setValidityState(e)},e.getSettings=function(e){h(S.content,S.settings,S.remove,S.sidePanel),W.config.getConfig().then((function(n){e(n)}))},e.setSettings=function(e,n){h(S.content,S.settings,S.sidePanel),W.config.setConfig(e).then((function(){n&&n(!0)})).catch((function(e){n&&n(!1,e.message)}))},e.registerOnSaveHandler=function(e){W.config.registerOnSaveHandler(e)},e.registerOnRemoveHandler=function(e){W.config.registerOnRemoveHandler(e)}}(Fe||(Fe={})),function(e){function n(e){var n=e.height&&"number"!=typeof e.height?t(e.height):e.height,o=e.width&&"number"!=typeof e.width?t(e.width):e.width;return{url:e.url,card:e.card,height:n,width:o,title:e.title,fallbackUrl:e.fallbackUrl,completionBotId:e.completionBotId}}function t(e){return e===U.Large?U.Large:e===U.Medium?U.Medium:U.Small}e.startTask=function(e,t){return ye.open(n(e),t)},e.updateTask=function(e){ye.resize(e)},e.submitTask=function(e,n){ye.submit(e,n)}}(De||(De={})),function(e){!function(e){e.Dropbox="DROPBOX",e.Box="BOX",e.Sharefile="SHAREFILE",e.GoogleDrive="GOOGLEDRIVE",e.Egnyte="EGNYTE"}(e.CloudStorageProvider||(e.CloudStorageProvider={})),function(e){e[e.Sharepoint=0]="Sharepoint",e[e.WopiIntegration=1]="WopiIntegration",e[e.Google=2]="Google"}(e.CloudStorageProviderType||(e.CloudStorageProviderType={})),e.getCloudStorageFolders=function(e){return new Promise((function(n){if(h(S.content),!e||0==e.length)throw new Error("[files.getCloudStorageFolders] channelId name cannot be null or empty");n(ce("files.getCloudStorageFolders",e))}))},e.addCloudStorageFolder=function(e){return new Promise((function(n){if(h(S.content),!e||0==e.length)throw new Error("[files.addCloudStorageFolder] channelId name cannot be null or empty");n(ue("files.addCloudStorageFolder",[e]))})).then((function(e){var n=e[0],t=e[1],o=e[2];if(n)throw n;return[t,o]}))},e.deleteCloudStorageFolder=function(e,n){return new Promise((function(t){if(h(S.content),!e)throw new Error("[files.deleteCloudStorageFolder] channelId name cannot be null or empty");if(!n)throw new Error("[files.deleteCloudStorageFolder] folderToDelete cannot be null or empty");t(ce("files.deleteCloudStorageFolder",e,n))}))},e.getCloudStorageFolderContents=function(e,n){return new Promise((function(t){if(h(S.content),!e||!n)throw new Error("[files.getCloudStorageFolderContents] folder/providerCode name cannot be null or empty");if("isSubdirectory"in e&&!e.isSubdirectory)throw new Error("[files.getCloudStorageFolderContents] provided folder is not a subDirectory");t(ce("files.getCloudStorageFolderContents",e,n))}))},e.openCloudStorageFile=function(e,n,t){if(h(S.content),!e||!n)throw new Error("[files.openCloudStorageFile] file/providerCode cannot be null or empty");if(e.isSubdirectory)throw new Error("[files.openCloudStorageFile] provided file is a subDirectory");le("files.openCloudStorageFile",[e,n,t])},e.openFilePreview=function(e){h(S.content),le("openFilePreview",[e.entityId,e.title,e.description,e.type,e.objectUrl,e.downloadUrl,e.webPreviewUrl,e.webEditUrl,e.baseUrl,e.editFile,e.subEntityId,e.viewerAction,e.fileOpenPreference,e.conversationId])},e.isSupported=function(){return!!I.supports.files}}(Le||(Le={})),function(e){!function(e){e.getUserJoinedTeams=function(e){return new Promise((function(n){if(h(),(c.hostClientType===y.android||c.hostClientType===y.teamsRoomsAndroid||c.hostClientType===y.teamsPhones||c.hostClientType===y.teamsDisplays)&&!g("2.0.1")){var t={errorCode:$.OLD_PLATFORM};throw new Error(JSON.stringify(t))}n(re("getUserJoinedTeams",e))}))},e.getConfigSetting=function(e){return new Promise((function(n){h(),n(re("getConfigSetting",e))}))},e.isSupported=function(){return!!I.supports.teams&&!!I.supports.teams.fullTrust}}(e.fullTrust||(e.fullTrust={}))}(We||(We={})),function(e){e.getPairedMeetingRoomInfo=function(){return new Promise((function(e){h(),e(ce("meetingRoom.getPairedMeetingRoomInfo"))}))},e.sendCommandToPairedMeetingRoom=function(e){return new Promise((function(n){if(!e||0==e.length)throw new Error("[meetingRoom.sendCommandToPairedMeetingRoom] Command name cannot be null or empty");h(),n(ce("meetingRoom.sendCommandToPairedMeetingRoom",e))}))},e.registerMeetingRoomCapabilitiesUpdateHandler=function(e){if(!e)throw new Error("[meetingRoom.registerMeetingRoomCapabilitiesUpdateHandler] Handler cannot be null");h(),j("meetingRoom.meetingRoomCapabilitiesUpdate",(function(n){h(),e(n)}))},e.registerMeetingRoomStatesUpdateHandler=function(e){if(!e)throw new Error("[meetingRoom.registerMeetingRoomStatesUpdateHandler] Handler cannot be null");h(),j("meetingRoom.meetingRoomStatesUpdate",(function(n){h(),e(n)}))},e.isSupported=function(){return!!I.supports.meetingRoom}}(Ue||(Ue={})),function(e){e.showNotification=function(e){h(S.content),le("notifications.showNotification",[e])},e.isSupported=function(){return!!I.supports.notifications}}(He||(He={})),function(e){!function(e){e.Reset="Reset",e.ZoomIn="ZoomIn",e.ZoomOut="ZoomOut",e.PanLeft="PanLeft",e.PanRight="PanRight",e.TiltUp="TiltUp",e.TiltDown="TiltDown"}(e.ControlCommand||(e.ControlCommand={})),function(e){e[e.CommandResetError=0]="CommandResetError",e[e.CommandZoomInError=1]="CommandZoomInError",e[e.CommandZoomOutError=2]="CommandZoomOutError",e[e.CommandPanLeftError=3]="CommandPanLeftError",e[e.CommandPanRightError=4]="CommandPanRightError",e[e.CommandTiltUpError=5]="CommandTiltUpError",e[e.CommandTiltDownError=6]="CommandTiltDownError",e[e.SendDataError=7]="SendDataError"}(e.ErrorReason||(e.ErrorReason={})),function(e){e[e.None=0]="None",e[e.ControlDenied=1]="ControlDenied",e[e.ControlNoResponse=2]="ControlNoResponse",e[e.ControlBusy=3]="ControlBusy",e[e.AckTimeout=4]="AckTimeout",e[e.ControlTerminated=5]="ControlTerminated",e[e.ControllerTerminated=6]="ControllerTerminated",e[e.DataChannelError=7]="DataChannelError",e[e.ControllerCancelled=8]="ControllerCancelled",e[e.ControlDisabled=9]="ControlDisabled",e[e.ControlTerminatedToAllowOtherController=10]="ControlTerminatedToAllowOtherController"}(e.SessionTerminatedReason||(e.SessionTerminatedReason={})),e.getCapableParticipants=function(e){if(!e)throw new Error("[remoteCamera.getCapableParticipants] Callback cannot be null");h(S.sidePanel),le("remoteCamera.getCapableParticipants",e)},e.requestControl=function(e,n){if(!e)throw new Error("[remoteCamera.requestControl] Participant cannot be null");if(!n)throw new Error("[remoteCamera.requestControl] Callback cannot be null");h(S.sidePanel),le("remoteCamera.requestControl",[e],n)},e.sendControlCommand=function(e,n){if(!e)throw new Error("[remoteCamera.sendControlCommand] ControlCommand cannot be null");if(!n)throw new Error("[remoteCamera.sendControlCommand] Callback cannot be null");h(S.sidePanel),le("remoteCamera.sendControlCommand",[e],n)},e.terminateSession=function(e){if(!e)throw new Error("[remoteCamera.terminateSession] Callback cannot be null");h(S.sidePanel),le("remoteCamera.terminateSession",e)},e.registerOnCapableParticipantsChangeHandler=function(e){if(!e)throw new Error("[remoteCamera.registerOnCapableParticipantsChangeHandler] Handler cannot be null");h(S.sidePanel),j("remoteCamera.capableParticipantsChange",e)},e.registerOnErrorHandler=function(e){if(!e)throw new Error("[remoteCamera.registerOnErrorHandler] Handler cannot be null");h(S.sidePanel),j("remoteCamera.handlerError",e)},e.registerOnDeviceStateChangeHandler=function(e){if(!e)throw new Error("[remoteCamera.registerOnDeviceStateChangeHandler] Handler cannot be null");h(S.sidePanel),j("remoteCamera.deviceStateChange",e)},e.registerOnSessionStatusChangeHandler=function(e){if(!e)throw new Error("[remoteCamera.registerOnSessionStatusChangeHandler] Handler cannot be null");h(S.sidePanel),j("remoteCamera.sessionStatusChange",e)},e.isSupported=function(){return!!I.supports.remoteCamera}}(Be||(Be={})),function(e){e.selectAppEntity=function(e,n,t,o){if(h(S.content),!e||0==e.length)throw new Error("[appEntity.selectAppEntity] threadId name cannot be null or empty");if(!o)throw new Error("[appEntity.selectAppEntity] Callback cannot be null");le("appEntity.selectAppEntity",[e,n,t],o)},e.isSupported=function(){return!!I.supports.appEntity}}(je||(je={})),function(e){!function(e){e[e.Regular=0]="Regular",e[e.Private=1]="Private",e[e.Shared=2]="Shared"}(e.ChannelType||(e.ChannelType={})),e.getTeamChannels=function(e,n){if(h(S.content),!e)throw new Error("[teams.getTeamChannels] groupId cannot be null or empty");if(!n)throw new Error("[teams.getTeamChannels] Callback cannot be null");le("teams.getTeamChannels",[e],n)},e.refreshSiteUrl=function(e,n){if(h(),!e)throw new Error("[teams.refreshSiteUrl] threadId cannot be null or empty");if(!n)throw new Error("[teams.refreshSiteUrl] Callback cannot be null");le("teams.refreshSiteUrl",[e],n)},e.isSupported=function(){return!!I.supports.teams}}(ze||(ze={}))})(),o})()},,,,,function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=t(54);t(25),window.wpo365=window.wpo365||{},window.wpo365.pintraRedirect=new o.PintraRedirect},function(e,n,t){"use strict";var o=this&&this.__awaiter||function(e,n,t,o){return new(t||(t=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,s)}c((o=o.apply(e,n||[])).next())}))},i=this&&this.__generator||function(e,n){var t,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=n.call(e,a)}catch(e){r=[6,e],o=0}finally{t=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(n,"__esModule",{value:!0});var r=t(48),a=function(){function e(){var e=this;this.inIframe=!1,this.isTeams=!1,this.redirectTo="",this.teamsToken=null,this.teamsContext=null,this.tryTeamsAuth=function(n,t){return o(e,void 0,void 0,(function(){var e,o,a,s=this;return i(this,(function(i){switch(i.label){case 0:if(!r.app.isInitialized())return console.log("PintraRedirect.tryTeamsAuth -> Microsoft Teams SDK not initialized"),[2];r.app.getContext().then((function(e){return s.teamsContext=e})),i.label=1;case 1:return i.trys.push([1,3,,4]),console.log("PintraRedirect.tryTeamsAuth -> Trying to get token"),e=this,[4,r.authentication.getAuthToken({})];case 2:return e.teamsToken=i.sent(),console.log("PintraRedirect.tryTeamsAuth -> Token: "+this.teamsToken.substr(0,25)+"..."),o={state:t,id_token:this.teamsToken},this.formPost(o,window.wpo365.siteUrl?window.wpo365.siteUrl:window.location.href),[3,4];case 3:return a=i.sent(),console.debug("PintraRedirect.tryTeamsAuth -> sso failed [reason: "+a+"]"),this.teamsPopup(n),this.showErrorMessage(a),r.app.notifyFailure({reason:r.app.FailedReason.AuthFailed,message:a}),[3,4];case 4:return[2]}}))}))},this.teamsPopup=function(n){var t=function(){r.authentication.authenticate({url:n,width:600,height:535})};t(),window.wpo365&&window.wpo365.isWpLogin?e.observePopupClosed():e.fallbackButtonAndListeners(t)},this.showErrorMessage=function(e){document.getElementById("wpo365RedirectError").innerHTML='<br/><div style="font-family: Sans-Serif; padding: 20px; text-align: center; font-size: 13px; color: #8c8c8c"><strong>Important information for administrators</strong></span><br/><br/>Your <strong>WPO365 | LOGIN</strong> plugin now supports a more integrated single sign-on experience for Microsoft Teams Tabs and Apps.<br/><br/>Please update your App Manifest. <a href="https://docs.wpo365.com/article/70-adding-a-wordpress-tab-to-microsoft-teams-and-use-single-sign-on">Continue reading</a><br/><br/>[Exception details: '+e+"]</div>"},this.fallbackButtonAndListeners=function(n){var t=document.getElementById("wpo365RedirectLoadingOther");t||(t=document.getElementById("wpo365OpenIdRedirect"));var o=document.createElement("button");o.setAttribute("style","border: 1px solid #8c8c8c; background: #ffffff;"),o.className="pintraRedirectMsSignin",o.innerHTML='<div style="display: flex; height: 41px; box-sizing: border-box; pointer: cursor;"><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMSIgaGVpZ2h0PSIyMSIgdmlld0JveD0iMCAwIDIxIDIxIj48dGl0bGU+TVMtU3ltYm9sTG9ja3VwPC90aXRsZT48cmVjdCB4PSIxIiB5PSIxIiB3aWR0aD0iOSIgaGVpZ2h0PSI5IiBmaWxsPSIjZjI1MDIyIi8+PHJlY3QgeD0iMSIgeT0iMTEiIHdpZHRoPSI5IiBoZWlnaHQ9IjkiIGZpbGw9IiMwMGE0ZWYiLz48cmVjdCB4PSIxMSIgeT0iMSIgd2lkdGg9IjkiIGhlaWdodD0iOSIgZmlsbD0iIzdmYmEwMCIvPjxyZWN0IHg9IjExIiB5PSIxMSIgd2lkdGg9IjkiIGhlaWdodD0iOSIgZmlsbD0iI2ZmYjkwMCIvPjwvc3ZnPg=="><span style="white-space: nowrap; margin-left: 15px; padding-right: 12px; font-weight: 600; font-size: 15px; line-height: 41px; color: #5e5e5e;">Sign in with Microsoft</span>',o.onclick=n,t.appendChild(o),e.observePopupClosed()},this.observePopupClosed=function(){window.wpo365ReloadInterval=setInterval((function(){localStorage.getItem("wpo365PopupClosed")&&(localStorage.removeItem("wpo365PopupClosed"),clearInterval(window.wpo365ReloadInterval),e.redirectTo?e.isTeams?window.location.href=e.getServerRelativePath(e.redirectTo):window.location.href=-1==e.redirectTo.indexOf("http")?window.location.protocol+":/"+e.redirectTo:e.redirectTo:window.wpo365&&window.wpo365.siteUrl?e.isTeams?window.location.href=window.location.href=e.getServerRelativePath(window.wpo365.siteUrl):window.location.href=window.wpo365.siteUrl:window.location.reload())}),100)},this.uuidv4=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var n=16*Math.random()|0;return("x"==e?n:3&n|8).toString(16)}))},this.queryString=function(e){var n=e.indexOf("?");if(-1==n)return{};for(var t=e.substr(n+1).split("&"),o={},i=0;i<t.length;i++){var r=t[i].split("=");o[r[0]]=2==r.length?r[1]:""}return o},this.getServerRelativePath=function(e){if(!e)return"/";var n=e.split("/");-1==e.indexOf("http")&&n.length>=1?n.splice(0,1):e.indexOf("http")>-1&&n.length>=3&&n.splice(0,3);var t="/"+n.join("/");return console.log("getServerRelativePath -> "+t),t},this.PopupCenter=function(e,n,t,o){void 0===t&&(t=600),void 0===o&&(o=535);var i=screen.availWidth,r=screen.availHeight;t>i&&(t=i),o>r&&(o=r);var a=(i-t)/2,s=(r-o)/2,c=window.open(e,n,"width="+t+",height="+o+",top="+s+",left="+a+"toolbar=no,menubar=no,scrollbars=no,location=no,status=no");c&&window.focus&&c.focus()},this.formPost=function(e,n){var t=document.createElement("form");for(var o in t.method="POST",t.action=n,t.style.display="none",e)if(e.hasOwnProperty(o)){var i=document.createElement("input");i.type="hidden",i.name=o,i.value=e[o],t.appendChild(i)}document.getElementById("wpo365OpenIdRedirect").appendChild(t),t.submit()},this.inIframe=window!=top,this.redirectTo=localStorage.getItem("wpo365RedirectTo"),this.isTeams=!!localStorage.getItem("wpo365IsTeams")||window.name&&["embedded-page-container","extension-tab-frame"].indexOf(window.name)>=0,this.isTeams&&r.app.initialize(),!this.inIframe&&this.redirectTo&&(localStorage.setItem("wpo365PopupClosed","closed"),localStorage.removeItem("wpo365RedirectTo"),console.debug("PintraRedirect.contructor -> Trying to close authentication popup"),this.isTeams?(localStorage.removeItem("wpo365IsTeams"),r.app.isInitialized()?r.authentication.notifySuccess():r.app.initialize().then((function(){return r.authentication.notifySuccess()}))):window.close())}return e.prototype.toMsOnline=function(e,n,t){var o=this;if(void 0===e&&(e=""),void 0===n&&(n=location.href),void 0===t&&(t=""),console.log("PintraRedirect.toMsOnline -> document.readyState: "+document.readyState),-1!=["interactive","complete"].indexOf(document.readyState)){e&&!/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,6})+$/.test(e)&&(console.log("WPO365 -> loginHint parameter ignored because it is not a valid email address"),e=""),n&&!/^((http|https):\/\/)([a-zA-Z0-9@:%._\-\+~#?&\/\$=]*)$/.test(n)&&(console.log("WPO365 -> pRedirectTo parameter ignored because it is not a valid (encoded) URL"),n=location.href),t&&!/^([a-zA-Z0-9])([a-zA-Z0-9\-\.])*(\.)([a-zA-Z0-9\-]){2,6}$/.test(t)&&(console.log("WPO365 -> domainHint parameter ignored because it is not a valid domain name"),t="");var i=!!window.wpo365.siteUrl?window.wpo365.siteUrl:window.location.href,a=this.queryString(window.location.href),s=0===Object.keys(this.queryString(i)).length?"?":"&";if(this.redirectTo="redirect_to"in a?decodeURIComponent(a.redirect_to):n,this.inIframe){localStorage.removeItem("wpo365PopupClosed"),localStorage.removeItem("wpo365RedirectTo"),localStorage.removeItem("wpo365IsTeams"),localStorage.setItem("wpo365RedirectTo",this.redirectTo);var c=""+i+s+"action=openidredirect&redirect_to="+this.redirectTo+"&domain_hint="+t+"&cb="+this.uuidv4();if(this.isTeams){localStorage.setItem("wpo365IsTeams","teams");var u=this;setTimeout((function(){if(!r.app.isInitialized())return console.log("PintraRedirect.toMsOnline -> Failed to initialize Microsoft Teams SDK in a timely fashion"),void o.showErrorMessage("Could not initialize the Microsoft Teams SDK [unknown error].");o.tryTeamsAuth(c,o.redirectTo),setTimeout((function(){u.teamsContext||(console.log("PintraRedirect.toMsOnline -> Failed to acquire a Microsoft Teams context in a timely fashion"),u.teamsPopup(c))}),500)}),500)}else this.PopupCenter(c,"msOnline"),this.fallbackButtonAndListeners((function(){o.PopupCenter(c,"msOnline")}))}else{var l={action:"openidredirect",login_hint:e,domain_hint:t,redirect_to:this.redirectTo};this.formPost(l,""+i+s+"cb="+this.uuidv4())}}else setTimeout((function(){return o.toMsOnline(e,n,t)}),500)},e}();n.PintraRedirect=a}]);